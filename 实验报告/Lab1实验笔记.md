## Lab1实验笔记

### 一、操作系统的启动

​		计算机该如何启动？软硬件需要相互控制，先启动谁？这是一个先有鸡还是先有蛋的问题。为了解决这个问题，我们将硬盘等硬件设备的状态在启动前总是至于一个最通用、简单的状态(因此此状态也是功能最弱的状态)；继而我们可以通过逐步设置提升硬件环境的能力，逐步提升系统的灵活性。在操作系统课程设计中，我们用GXemul作为硬件仿真器进行试验，在其上完成操作系统的设计。

#### 1.内核

​		内核是操作系统最重要的部分，它能够与硬件进行交互，从而管理各种硬件。为了启动操作系统，我们需要将内核代码运行起来。内核的代码要放在哪里才能被CPU使用呢？磁盘不能被CPU直接访问，而内存RAM是易失性存储器，显然不适合安置内核代码。故而我们选择将内核代码放在非易失性存储器ROM或FLASH上。

​		当然，直接将内核放在ROM或FLASH上也有缺点。诸如CPU能访问的非易失存储空间有限、只能启动一个操作系统、不利于操作系统的移植等。为了解决这些问题，设计人员一般会将硬件初始化的相关工作放在名为bootloader的程序中来完成。

​		使用bootloader进行加载，有许多方便的地方。我们可以将更少的指令放在ROM或FLASH中，而将操作系统内核的主要部分放在磁盘中，只要bootloader完成硬件初始化，就可以从磁盘中拉取内核程序，使得我们对内核能够有更加大的操作空间（更复杂的内核、更多样的内核等）。

#### 2.Bootloader

​		bootloader通常分为stage1和stage2两个部分。

​		**stage1：**此阶段用于初始化基础硬件设备（中断、时钟等）。由于RAM尚未完成初始化，stage1的运行会受到很多限制。故而stage1还会开辟RAM空间，为stage2做准备。

​		**stage2：**此阶段运行在RAM上。程序将会对硬件进行进一步的初始化，将内核镜像文件读入RAM并为内核设置启动参数。"最后将CPU指令寄存器的内容设置为内核入口函数的地址，即可将控制权从bootloader转交给操作系统内核。"

​		上面阐述的是一种执行思维，在现实中不同的操作系统在实现上也会有所不同。

### 二、内核

#### 1.Makefile

​		在lab0的实验报告中，我简单的介绍了一下我对Makefile的理解。而在此处，Makefile写入了构建操作系统的各种语句，其内容在网站上有详细的解读。

​		